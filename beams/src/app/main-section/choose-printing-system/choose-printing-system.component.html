<div class="full-screen overflow-hidden position-relative">
    <!-- סרט תמונות רציף - מאחורי הכל כולל navBar -->
    <div class="image-film-container">
        <img *ngFor="let imagePath of getAllImagePaths(); let i = index" 
             [src]="imagePath" 
             [alt]="'Background image ' + (i + 1)"
             class="image-film-item"
             [style.animation-delay]="i * 10 + 's'">
        
        <!-- שכבה לבנה עם שקיפות מעל התמונות - הוסרה לבקשת המשתמש -->
        <!-- <div class="image-overlay-white"></div> -->
    </div>
    
    <div class="d-flex flex-grow-1 position-relative" style="z-index: 10;">

        <!-- CHOOSE PRINTING SYSTEM SIDE -->
        <div class="zx-settings-nav flex-shrink h-100 d-flex flex-column overflow-hidden position-relative"
            [class.zx-settings-nav-dark]="isDarkMode"
            style="background-color: rgba(255, 255, 255, 0.4); backdrop-filter: blur(2px);">

            <article #scrollContainer
                class="w-100 h-100 d-flex p-0 p-md-3 flex-column overflow-y-auto">

                <section class="d-flex flex-column w-100 vh-100-sm-none flex-shrink-0">

                    <article class="w-100 d-flex flex-column gap-2">

                        <div class="w-100 d-flex flex-column justify-content-between px-3 pt-4 pt-md-2 pb-4" style="padding-bottom: 1.8125rem !important;">

                            <div class="w-100 d-flex justify-content-center justify-content-md-between align-items-center">
                                <h6 class="mb-0 fw-bold zx-text-title-main" 
                                    style="color: var(--zx-green) !important;">
                                    {{'choose-system.step-1' | translate}}
                                </h6>
                            </div>

                        </div>
                    </article>

                    <article id="buttonElement"
                        class="zx-about-con-down w-100 d-flex flex-column gap-2 position-sticky top-0 flex-grow-1"
                        [class.zx-dark-gb]="isDarkMode">
                        <article
                            class="w-100 d-flex flex-column gap-2 flex-grow-1 justify-content-end justify-content-md-start px-3 px-md-0 flex-grow-1">

                            <!-- printingService BTNs and scroll container -->
                            <article
                                class="printing-service-btn-con-con d-flex flex-column gap-3 justify-content-between flex-grow-1"
                                style="max-width: 100%;">
                                <!-- printingService BTNs -->
                                <article class="printing-service-btn-con d-flex flex-column gap-3">
                                     <!-- Products BTNs -->
                                     <div class="row g-3">
                                         <!-- מצב טעינה - 3 כרטיסי דמה -->
                                         <ng-container *ngIf="isLoading">
                                             <div *ngFor="let item of [1,2,3]; let i = index" 
                                                 class="col-12 col-md-6 step-item-trans-product step-item shadow-85 d-flex p-2 gap-md-3 align-items-center justify-content-center position-relative"
                                                 [class.step-item-dark]="isDarkMode">
                                             <!-- כפתור המשך למוצר -->
                                             <button mat-stroked-button 
                                                     class="continue-to-product-btn opacity-75 loading-button-shine" 
                                                     disabled>
                                                 <span class="opacity-75 zx-text-tiny zx-text-sm-small text-center loading-dots-shine">...</span>
                                             </button>
                                             
                                             <div class="d-flex align-items-center gap-3">
                                                 <div class="product-icon zx-big-icon-size-trans d-flex align-items-center justify-content-center rounded loading-shimmer">
                                                 </div>
                                             </div>
                                             
                                             <div class="text-con-product d-flex flex-column flex-grow-1 justify-content-between">
                                                 <h6 class="fw-bold zx-text-big text-center text-muted opacity-75">
                                                     ...
                                                 </h6>
                                                 <span class="opacity-75 zx-text-tiny zx-text-sm-small text-center text-green">
                                                     ...
                                                 </span>
                                             </div>
                                             </div>
                                             <!-- כרטיסייה דמה למספר אי-זוגי של מוצרים -->
                                             <div class="col-12 col-md-6 step-item-trans-product d-none d-md-block"
                                                 style="visibility: hidden; pointer-events: none;">
                                             </div>
                                         </ng-container>
                                         
                                         <!-- מצב רגיל - מוצרים אמיתיים -->
                                         <ng-container *ngIf="!isLoading">
                                             <div *ngFor="let product of products; let i = index" 
                                                 (mouseenter)="onHoverProduct(product)"
                                                 (mouseleave)="onHoverProduct(null)"
                                                 [class.zx-step-choosen]="selectedProduct?._id === product._id"
                                                 class="col-12 col-md-6 step-item-trans-product step-item shadow-85 d-flex p-2 gap-md-3 align-items-center justify-content-center position-relative"
                                                 [class.step-item-dark]="isDarkMode">
                                        <!-- כפתור המשך למוצר -->
                                        <button mat-stroked-button 
                                                class="continue-to-product-btn rounded-2" 
                                                (click)="navigateToProduct(product); $event.stopPropagation()">
                                            <span class="opacity-75 zx-text-tiny zx-text-sm-small text-center">{{product.model || product.translatedName || 'המוצר'}} במידות שלך</span>
                                        </button>
                                        
                                        <div class="d-flex align-items-center gap-3">
                                            <div class="product-icon zx-big-icon-size-trans d-flex align-items-center justify-content-center rounded position-relative">
                                                <app-product-mini-preview #miniPreview [product]="product" style="width: 100%; height: 100%;"></app-product-mini-preview>
                                                <!-- כיסוי שקוף מעל המודל התלת-ממדי -->
                                                <div class="product-3d-overlay" 
                                                     (click)="removeOverlay($event, miniPreview)"
                                                     (mouseenter)="showHintForProduct(product._id)"
                                                     (mouseleave)="hideHintForProduct(product._id)">
                                                    <!-- טקסט הוראה בריחוף -->
                                                    <div class="overlay-hint" 
                                                         [class.show]="showHintMap[product._id]"
                                                         [@fadeInOut]="showHintMap[product._id] ? 'in' : 'out'">
                                                        לחץ לשינוי זוית מבט
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="text-con-product d-flex flex-column flex-grow-1 justify-content-between">
                                            <h6 class="fw-bold zx-text-big text-center">
                                                {{product.translatedName}}
                                            </h6>
                                            <span class="opacity-75 zx-text-tiny zx-text-sm-small text-center text-green">
                                                דגם - {{product.model || product.name || 'מוצר מותאם אישית'}}
                                            </span>
                                        </div>
                                        </div>
                                        </ng-container>
                                        
                                         <!-- כרטיסייה דמה למספר אי-זוגי של מוצרים -->
                                         <div *ngIf="!isLoading && products.length % 2 !== 0" 
                                             class="col-12 col-md-6 step-item-trans-product d-none d-md-block"
                                             style="visibility: hidden; pointer-events: none;">
                                         </div>
                                    </div>
                                
                                </article>
                            </article>
                        </article>

                    </article>

                    <div class="mat-toolbar-height d-lg-none"></div>
                </section>

                <article></article>

            </article>
            <!-- action BTN -->
            <div class="w-100 p-2 shadow-85-strong zx-z-index-1 hide-main-btn"
                *ngIf="printingService === 'express' || printingService === 'plotter' || printingService === 'ph'"
                [class.show-main-btn]="isSystemSet">
                <button type="button" mat-raised-button color="primary"
                    class="text-white rounded-2 w-100 zx-medium-btn zx-main-btn-effects fw-bold"
                    (click)="onSetPrintingService()">
                    {{ continueToServiceText }}
                </button>
            </div>
            <!-- // action BTN -->

        </div>

        <!-- // CHOOSE PRINTING SYSTEM SIDE -->
         

        <!-- RIGHT SIDE CONTAINER - טקסט מעל התמונה -->
        <div class="d-none d-md-flex h-100 flex-grow-1 position-relative justify-content-center align-items-end" 
             style="z-index: 10; padding-bottom: 80px;">
            <!-- טקסט קבוע מעל התמונה -->
            <div *ngFor="let key of [currentTransitionKey]; trackBy: trackByTransitionKey" 
                 class="hero-text-block" 
                 [@fadeInOut]="key"
                 style="position: absolute; bottom: 80px; left: 50%; transform: translateX(-50%);">
                <!-- שכבת רקע כהה-שקופה -->
                <div class="hero-text-bg-overlay"></div>
                
                <!-- תוכן הטקסטים -->
                <div class="text-responsive">
                    <!-- כותרת ראשית -->
                    <h6 class="fw-bold zx-text-title-main mb-3" 
                        style="color: var(--zx-green) !important; position: relative !important; z-index: 2 !important;">
                        {{displayedTitle}}
                    </h6>
                    
                    <!-- טקסט הסבר -->
                    <p class="mb-5 text-shadow opacity-90 text-hover-effect zx-text-big"
                       style="line-height: 1.4; max-width: 800px; margin-left: auto;">
                        {{displayedText}}
                    </p>
                    
                    <!-- סלוגן -->
                    <p class="text-shadow opacity-80 text-hover-effect subtitle text-start"
                       style="line-height: 1.3; max-width: 600px; margin-right: auto; letter-spacing: 0.02em; margin-bottom: 0.25rem;">
                        {{displayedSubtitle}}
                    </p>
                </div>
            </div>
        </div>
        <!-- // LEFT SIDE CONTAINER -->

    </div>
</div>