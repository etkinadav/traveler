<div class="guess-tree-container" [class.celebration]="allRevealed">
  
  <!-- 爪转 转专转 注  拽驻 -->
  <div class="title-animation" *ngIf="showTitleAnimation">
    <h1 class="main-title"> 转 砖 ! </h1>
    <div class="confetti">
      <span *ngFor="let conf of [].constructor(50)"></span>
    </div>
  </div>

  <!-- 转专转 砖 -->
  <h2 class="subtitle" *ngIf="!showTitleAnimation">砖拽 砖 转 -   转 砖</h2>

  <!-- 注转 转爪 -->
  <div class="guess-result" 
       *ngIf="showGuessResult" 
       [class.success]="guessResultType === 'success'"
       [class.failure]="guessResultType === 'failure'">
    <h1 class="result-message">{{ guessResultMessage }}</h1>
  </div>

  <!-- 砖砖转 注爪 -->
  <div class="trees-container" *ngIf="!showTitleAnimation">
    
    <!-- 注抓 1: 拽专 -->
    <div class="tree-card" [class.revealed]="trees[0].revealed">
      <div class="tree-image">
        <div class="tree-cover" *ngIf="!trees[0].revealed">
          
        </div>
        <div class="tree-with-fruits" *ngIf="trees[0].revealed">
          <div class="tree-icon"></div>
          <div class="tree-reveal">
            <img src="https://e1.pngegg.com/pngimages/68/417/png-clipart-fruits-carambola-fruit.png" alt="拽专" class="fruit fruit-1">
            <img src="https://e1.pngegg.com/pngimages/68/417/png-clipart-fruits-carambola-fruit.png" alt="拽专" class="fruit fruit-2">
            <img src="https://e1.pngegg.com/pngimages/68/417/png-clipart-fruits-carambola-fruit.png" alt="拽专" class="fruit fruit-3">
          </div>
        </div>
        <div class="veil" [class.lifting]="trees[0].revealed"></div>
      </div>
      
      <div class="input-container">
        <div class="input-row" *ngFor="let row of trees[0].inputs; let i = index">
          <input 
            *ngFor="let char of row; let j = index"
            type="text" 
            [id]="'input-0-' + i + '-' + j"
            maxlength="1"
            class="char-input"
            [class.revealed]="isCharRevealed(trees[0], i, j)"
            [class.current]="getCurrentTree().id === trees[0].id"
            [value]="char"
            [readonly]="isCharRevealed(trees[0], i, j)"
            (keydown)="onKeyDown($event, 0, i, j)"
            (input)="setInputValue(0, i, j, $any($event.target).value)"
          />
        </div>
      </div>
    </div>

    <!-- 注抓 2:   -->
    <div class="tree-card" [class.revealed]="trees[1].revealed">
      <div class="tree-image">
        <div class="tree-cover" *ngIf="!trees[1].revealed">
          
        </div>
        <div class="tree-with-fruits" *ngIf="trees[1].revealed">
          <div class="tree-icon"></div>
          <div class="tree-reveal">
            <img src="https://opa.cy/wp-content/uploads/2021/02/mango-maya.jpg" alt=" " class="fruit fruit-1">
            <img src="https://opa.cy/wp-content/uploads/2021/02/mango-maya.jpg" alt=" " class="fruit fruit-2">
            <img src="https://opa.cy/wp-content/uploads/2021/02/mango-maya.jpg" alt=" " class="fruit fruit-3">
          </div>
        </div>
        <div class="veil" [class.lifting]="trees[1].revealed"></div>
      </div>
      
      <div class="input-container">
        <div class="input-row" *ngFor="let row of trees[1].inputs; let i = index">
          <input 
            *ngFor="let char of row; let j = index"
            type="text" 
            [id]="'input-1-' + i + '-' + j"
            maxlength="1"
            class="char-input"
            [class.revealed]="isCharRevealed(trees[1], i, j)"
            [class.current]="getCurrentTree().id === trees[1].id"
            [class.pending]="currentTreeIndex < 1"
            [value]="char"
            [readonly]="isCharRevealed(trees[1], i, j)"
            (keydown)="onKeyDown($event, 1, i, j)"
            (input)="setInputValue(1, i, j, $any($event.target).value)"
          />
        </div>
      </div>
    </div>

    <!-- 注抓 3:  住 -->
    <div class="tree-card" [class.revealed]="trees[2].revealed">
      <div class="tree-image">
        <div class="tree-cover" *ngIf="!trees[2].revealed">
          
        </div>
        <div class="tree-with-fruits" *ngIf="trees[2].revealed">
          <div class="tree-icon"></div>
          <div class="tree-reveal">
            <img src="https://rawabihypermarket.com/uploads/product_images/featured_image/844989.jpg" alt=" 住" class="fruit fruit-1">
            <img src="https://rawabihypermarket.com/uploads/product_images/featured_image/844989.jpg" alt=" 住" class="fruit fruit-2">
            <img src="https://rawabihypermarket.com/uploads/product_images/featured_image/844989.jpg" alt=" 住" class="fruit fruit-3">
          </div>
        </div>
        <div class="veil" [class.lifting]="trees[2].revealed"></div>
      </div>
      
      <div class="input-container">
        <div class="input-row" *ngFor="let row of trees[2].inputs; let i = index">
          <input 
            *ngFor="let char of row; let j = index"
            type="text" 
            [id]="'input-2-' + i + '-' + j"
            maxlength="1"
            class="char-input"
            [class.revealed]="isCharRevealed(trees[2], i, j)"
            [class.current]="getCurrentTree().id === trees[2].id"
            [class.pending]="currentTreeIndex < 2"
            [value]="char"
            [readonly]="isCharRevealed(trees[2], i, j)"
            (keydown)="onKeyDown($event, 2, i, j)"
            (input)="setInputValue(2, i, j, $any($event.target).value)"
          />
        </div>
      </div>
    </div>
  </div>

  <!-- 驻拽 拽驻 -->
  <div class="confetti-overlay" *ngIf="showConfetti">
    <div class="confetti-item" *ngFor="let i of [].constructor(100)">
      {{ getRandomConfetti() }}
    </div>
  </div>

</div>
